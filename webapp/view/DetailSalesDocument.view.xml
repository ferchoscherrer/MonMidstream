<mvc:View xmlns:f="sap.f" xmlns:rowmodes="sap.ui.table.rowmodes" controllerName="com.triiari.retrobilling.controller.DetailSalesDocument."
    displayBlock="true"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
	xmlns:form="sap.ui.layout.form"
    xmlns:core="sap.ui.core"
    xmlns:t="sap.ui.table" 
    xmlns:l="sap.ui.layout">
    <f:DynamicPage
        headerExpanded="true"
        headerPinned="true"
        fitContent="true"
        showFooter="true">
        <f:title>
            <f:DynamicPageTitle >
                <f:heading>
                    <Title text="{=${i18n>order}} {=${mCreateOrder>/oSalesOrder/DocNumber}}" />
                </f:heading>
                <f:actions>
                    <Button tooltip="{i18n>close}" icon="sap-icon://decline" press=".onClose" />
                </f:actions>
            </f:DynamicPageTitle>
        </f:title>
        <f:header>
            <f:DynamicPageHeader>
                <form:SimpleForm
                    editable="true"
                    width="100%"
                    layout="ColumnLayout"
                    labelSpanXL="2"
                    labelSpanL="2"
                    labelSpanM="3"
                    labelSpanS="12"
                    adjustLabelSpan="false"
                    emptySpanXL="7"
                    emptySpanL="2"
                    emptySpanM="2"
                    emptySpanS="0"
                    columnsXL="6"
                    columnsL="4"
                    columnsM="2"
                    singleContainerFullSize="false" >
                    <form:content>
                        <core:Title text="{i18n>detailOrder}"/>
                        <Label text="{i18n>order}"/>
                        <Text text="{mCreateOrder>/oSalesOrder/RefDoc}" />
                        <Label text="{i18n>stimate}" />
                        <Text text="{mCreateOrder>/oSalesOrder/DocNumber}" />
                        <Label text="{i18n>dateOrder}" />
                        <Text 
                            text="{
                                path:'mCreateOrder>/oSalesOrder/DocDate',
                                type: 'sap.ui.model.type.Date',
                                formatOptions:{
                                    style: 'long'
                                }
                            }" 
                        />
                        <Label text="{i18n>request}" />
                        <Text text="" />
                        <Label text="{i18n>request}" />
                        <Text text="{mCreateOrder>/oSalesOrder/SoldTo}"/>
                        <Label text="{i18n>orderNoCustomer}" />
                        <Text text="{mCreateOrder>/oSalesOrder/PurchNo}" />
                        <core:Title text="{i18n>confiDetail}" />
                        <Label text="{i18n>classOrder}" />
                        <Text text="{mCreateOrder>/oSalesOrder/DocType}" />
                        <Label text="{i18n>salesOrganization}" />
                        <Text text="{mCreateOrder>/oSalesOrder/SalesOrg}"/>
                        <Label text="{i18n>salesArea}" />
                        <Text text="{mCreateOrder>/oSalesOrder/SalesOff}"/>
                        <Label text="{i18n>sector}" />
                        <Text text="{mCreateOrder>/oSalesOrder/Division}"/>
                        <Label text="{i18n>factor}" />
                        <Text text="{
                            path: 'mCreateOrder>/oQuery/iFactor',
                            type: 'sap.ui.model.type.Float',
                            formatOptions: {
                                groupingEnabled: true,
                                groupingSeparator: ',',
                                decimalSeparator: '.',
                                minFractionDigits: 2,
                                maxFractionDigits: 2
                            }
                        }"/>
                    </form:content>
                </form:SimpleForm>
            </f:DynamicPageHeader>
        </f:header>
        <f:content>
            <t:Table 
                id="tblItemsSaleDocument"
                alternateRowColors="true"
                busyIndicatorDelay="0"
                enableColumnFreeze="true"
                enableSelectAll="true"
                enableColumnReordering="true"
                showNoData="true"
                rowSelectionChange="onSelectRowItemSaleDocument"
                rows="{mCreateOrder>/oSalesOrder/ToItems/results}"
                selectionMode="MultiToggle">
                <!-- rows="{mCreateOrder>/oDetailSalesDocument/items}" -->
                <t:rowMode>
                    <rowmodes:Auto  />
                </t:rowMode>
                <t:extension>
                    <OverflowToolbar style="Clear">
                        <!-- <Title text="{i18n>items} ({= ${mCreateOrder>/oDetailSalesDocument/items}.length })" /> -->
                        <Title text="{i18n>items} ({= ${mCreateOrder>/oSalesOrder/ToItems/results}.length })" />
                        <ToolbarSpacer/>
                        <Button text="{i18n>create}" press="." type="Emphasized" icon="sap-icon://create"/>
                        <Button text="{i18n>edit}" press=".editSelectedPositions" type="Emphasized" icon="sap-icon://edit"
                            enabled="{mCreateOrder>/oConfig/oAcctionTblItemSalesDocumentSingle/enabled}"
                        />
                        <Button text="{i18n>delete}" press=".onConfirmRemovePosition" type="Emphasized" icon="sap-icon://decline"
                            enabled="{mCreateOrder>/oConfig/oAcctionTblItemSalesDocument/enabled}"
                        />
                        <ToolbarSeparator />
                        <Button press=".onOpenPositionPartitioning" enabled="{mCreateOrder>/oConfig/oAcctionTblItemSalesDocumentSingle/enabled}" 
                            type="Default" icon="sap-icon://copy" tooltip="{i18n>copy}"
                        />
                    </OverflowToolbar>
                </t:extension>
                <t:columns >
                    <t:Column width="6rem" hAlign="Center" >
                        <Text text="{i18n>pos}" />
                        <t:template >
                            <Text text="{path: 'mCreateOrder>ItmNumber'}"/>
                        </t:template>
                    </t:Column>
                    <t:Column >
                        <Text text="{i18n>material}"/>
                        <t:template >
                            <Text text="{path: 'mCreateOrder>Material'}"/>
                        </t:template>
                    </t:Column>

                    <t:Column >
                        <Text text="{i18n>description}"/>
                        <t:template >
                            <Text text="{path: 'mCreateOrder>ShortText'}"/>
                        </t:template>
                    </t:Column>

                    <t:Column >
                        <Text text="{i18n>quantity}"/>
                        <t:template >
                            <Input value="{path: 'mCreateOrder>TargetQty'}" editable="{path: 'mCreateOrder>editQuantity'}" submit=".submitQuantity" />
                            <!-- <Text text="{path: 'mCreateOrder>TargetQty'}"/> -->
                        </t:template>
                    </t:Column>

                    <t:Column >
                        <Text text="{i18n>umb}"/>
                        <t:template >
                            <Text text="{path: 'mCreateOrder>TargetQu'}"/>
                        </t:template>
                    </t:Column>                    
                    <t:Column >
                        <Text text="{i18n>currency}"/>
                        <t:template>
                            <Text text="{path: 'mCreateOrder>Currency'}"/>
                        </t:template>
                    </t:Column>
                    <t:Column hAlign="End">
                        <Text text="{i18n>netValue}"/>
                        <t:template>
                            <Text text="{
                                path: 'mCreateOrder>NetValue',
                                type: 'sap.ui.model.type.Float',
                                formatOptions: {
                                    groupingEnabled: true,
                                    groupingSeparator: ',',
                                    decimalSeparator: '.',
                                    minFractionDigits: 2,
                                    maxFractionDigits: 2
                                }
                            }"/>
                        </t:template>
                    </t:Column>	
                    <t:Column hAlign="End">
                        <Text text="{i18n>updatedPrice}"/>
                        <t:template>
                            <Text text="{
                                path: 'mCreateOrder>TargetValCalculate',
                                type: 'sap.ui.model.type.Float',
                                formatOptions: {
                                    groupingEnabled: true,
                                    groupingSeparator: ',',
                                    decimalSeparator: '.',
                                    minFractionDigits: 2,
                                    maxFractionDigits: 2
                                }
                            }"/>
                        </t:template>
                    </t:Column>	
                    <t:Column width="4rem" hAlign="Center" >
                        <t:template>
                            <Button icon="sap-icon://journey-arrive" press="." />
                        </t:template>
                    </t:Column>	
                </t:columns>
                <t:noData>
                    <IllustratedMessage
                        illustrationType="sapIllus-SimpleEmptyList"
                        enableVerticalResponsiveness="true"
                        title="{i18n>thereAreNotEntriesYet}"
                        description="{i18n>thereAreNotEntriesYetDesc}"/>
                </t:noData>
            </t:Table>
        </f:content>
        <f:footer>
            <OverflowToolbar >
                <ToolbarSpacer />
                <Button type="Reject" text="{i18n>cancel}" press=".onClose" icon="sap-icon://undo"  />
                <Button type="Accept" text="{i18n>createOrder}" press="." icon="sap-icon://create-form"  />
            </OverflowToolbar>
        </f:footer>
    </f:DynamicPage>
</mvc:View>